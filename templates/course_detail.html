{% extends 'base.html' %}

{% block title %}{{ course.name }} - Premier Medical And Technical Institute{% endblock %}

{% block content %}
<!-- Course Header Section - Edge-to-Edge -->
<section class="course-header"
    style="background: linear-gradient(135deg, #1e3a8a, #3b82f6); color: white; padding: 6rem 0; margin-top: -3rem; width: 100%;">
    <div class="container">
        <div style="max-width: 900px;">
            <h1
                style="font-size: 3.5rem; font-weight: 900; margin-bottom: 2rem; line-height: 1.1; text-shadow: 0 4px 6px rgba(0,0,0,0.2); color: white;">
                {{ course.name }}
            </h1>
            <div style="display: flex; gap: 1.5rem; align-items: center; flex-wrap: wrap;">
                <div
                    style="background: rgba(255,255,255,0.15); padding: 10px 25px; border-radius: 50px; font-size: 1.1rem; font-weight: 700; display: flex; align-items: center; gap: 10px; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.2);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Course Duration: {{ course.duration }}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Course Overview Section -->
<section style="padding: 5rem 0; background: #f8fafc;">
    <div class="container">
        <div style="max-width: 1000px; margin: 0 auto;">
            <div
                style="background: white; padding: 4rem; border-radius: 2.5rem; box-shadow: 0 20px 40px rgba(0,0,0,0.05); border: 1px solid rgba(30, 58, 138, 0.05);">
                <h2
                    style="color: #1e3a8a; font-size: 2.25rem; font-weight: 800; margin-bottom: 2rem; display: flex; align-items: center; gap: 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                        style="color: #3b82f6;">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    Course Overview
                </h2>
                <div style="color: #475569; font-size: 1.3rem; line-height: 1.8; font-weight: 500;">
                    {{ course.description|linebreaks }}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Course Content Section (For Enrolled Students) -->
{% if is_enrolled %}
<section style="padding: 5rem 0; background: white;">
    <div class="container">
        <div style="max-width: 1000px; margin: 0 auto;">

            <!-- Modules -->
            <div style="margin-bottom: 4rem;">
                <h2
                    style="color: #1e3a8a; font-size: 2.25rem; font-weight: 800; margin-bottom: 2rem; display: flex; align-items: center; gap: 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                        style="color: #3b82f6;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Course Modules
                </h2>

                {% if modules %}
                <div class="grid grid-1" style="display: grid; gap: 1.5rem;">
                    {% for module in modules %}
                    <div class="card"
                        style="display: flex; justify-content: space-between; align-items: center; padding: 2rem; border-left: 5px solid {% if module.id in completed_module_ids %}#10b981{% else %}#3b82f6{% endif %}; transition: transform 0.2s ease;">
                        <div>
                            <h4 style="color: #1e3a8a; font-size: 1.25rem; margin-bottom: 0.5rem;">Module {{
                                module.order }}: {{ module.title }}</h4>
                            <p style="color: #64748b; margin: 0;">{{ module.description|truncatewords:20 }}</p>
                        </div>
                        <div style="text-align: right; min-width: 150px;">
                            {% if module.id in completed_module_ids %}
                            <span class="badge badge-success"
                                style="margin-bottom: 0.5rem; display: inline-block;">Completed</span>
                            <br>
                            {% endif %}
                            <a href="{% url 'module_detail' module.id %}" class="btn btn-outline"
                                style="padding: 0.5rem 1.5rem;">View Module</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="card" style="text-align: center; color: #64748b; padding: 3rem;">
                    <p>No modules available yet.</p>
                </div>
                {% endif %}
            </div>

            <!-- Course Resources -->
            <div style="margin-top: 4rem;">
                <h2
                    style="color: #1e3a8a; font-size: 2.25rem; font-weight: 800; margin-bottom: 2rem; display: flex; align-items: center; gap: 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                        style="color: #f59e0b;">
                        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                        <polyline points="13 2 13 9 20 9"></polyline>
                    </svg>
                    Course Resources
                </h2>

                {% if resources %}
                <div class="grid grid-1" style="display: grid; gap: 1.5rem;">
                    {% for resource in resources %}
                    <div class="card"
                        style="display: flex; justify-content: space-between; align-items: center; padding: 2rem; border-left: 5px solid #f59e0b; transition: transform 0.2s ease;">
                        <div>
                            <h4 style="color: #1e3a8a; font-size: 1.25rem; margin-bottom: 0.5rem;">
                                {% if resource.resource_type == 'PDF' %}
                                üìÑ
                                {% elif resource.resource_type == 'DOC' %}
                                üìù
                                {% elif resource.resource_type == 'PPT' %}
                                üìä
                                {% else %}
                                üìÅ
                                {% endif %}
                                {{ resource.title }}
                            </h4>
                            <p style="color: #64748b; margin: 0;">
                                {{ resource.uploaded_at|date:"F d, Y" }}
                                {% if resource.file %}
                                ‚Ä¢ {{ resource.get_file_size }} MB
                                {% endif %}
                            </p>
                        </div>
                        <div style="text-align: right; min-width: 150px;">
                            <a href="{% url 'download_resource' resource.id %}" class="btn btn-outline"
                                style="padding: 0.5rem 1.5rem;">Download</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="card" style="text-align: center; color: #64748b; padding: 3rem;">
                    <p>No resources available yet.</p>
                </div>
                {% endif %}
            </div>



            <!-- Course Certificate Section -->
            <div style="margin-top: 4rem;">
                <h2
                    style="color: #1e3a8a; font-size: 2.25rem; font-weight: 800; margin-bottom: 2rem; display: flex; align-items: center; gap: 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                        style="color: #0d9488;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Course Certificate
                </h2>

                <div class="card"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 2rem; border-left: 5px solid #0d9488;">
                    <div>
                        <h4 style="color: #1e3a8a; font-size: 1.25rem; margin-bottom: 0.5rem;">Completion Certificate
                        </h4>
                        <p style="color: #64748b; margin: 0;">Download your official course completion certificate.</p>
                    </div>
                    <div>
                        {% if certificate and certificate.pdf_file %}
                        <a href="{{ certificate.pdf_file.url }}" download class="btn btn-primary-solid"
                            style="background-color: #0d9488; border-color: #0d9488; padding: 0.75rem 2rem;">
                            Download Certificate
                        </a>
                        {% else %}
                        <button disabled class="btn btn-outline"
                            style="opacity: 0.6; cursor: not-allowed; background: #e2e8f0; color: #94a3b8; border-color: #cbd5e1;">
                            Certificate Pending
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>
{% else %}
<!-- Enrollment Section -->
<section style="padding: 8rem 0; background: white;">
    <div class="container">
        <div
            style="background: #f1f5f9; padding: 6rem 3rem; border-radius: 3rem; text-align: center; box-shadow: 0 30px 60px rgba(0,0,0,0.05); border: 1px solid rgba(30, 58, 138, 0.05);">
            <div style="max-width: 700px; margin: 0 auto;">
                <div
                    style="width: 100px; height: 100px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 3rem; box-shadow: 0 10px 20px rgba(30, 58, 138, 0.05);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none"
                        stroke="#1e3a8a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
                <h2 style="color: #1e3a8a; font-size: 3rem; margin-bottom: 2rem; font-weight: 900;">Begin Your Journey
                    Today</h2>
                <p style="color: #64748b; font-size: 1.25rem; line-height: 1.8; margin-bottom: 4rem; font-weight: 500;">
                    Join our premier training program and unlock your potential. Gain exclusive access to professional
                    modules, expert-curated materials, and a supportive community of healthcare aspirants.
                </p>

                <div style="display: flex; gap: 1.5rem; justify-content: center;">
                    {% if not user.is_authenticated %}
                    <a href="{% url 'register' %}" class="btn btn-primary-solid"
                        style="padding: 1.5rem 5rem; font-size: 1.4rem; font-weight: 800; border-radius: 50px; box-shadow: 0 15px 30px rgba(30, 58, 138, 0.25); transition: transform 0.3s ease;">Enroll
                        Now</a>
                    {% else %}
                    <a href="{% url 'contact' %}" class="btn btn-primary-solid"
                        style="padding: 1.5rem 5rem; font-size: 1.4rem; font-weight: 800; border-radius: 50px; box-shadow: 0 15px 30px rgba(30, 58, 138, 0.25); transition: transform 0.3s ease;">Enroll
                        Now</a>
                    {% endif %}
                </div>

                <p style="margin-top: 3rem; color: #94a3b8; font-size: 1.1rem; font-weight: 500;">
                    Have questions? <a href="{% url 'contact' %}"
                        style="color: #3b82f6; font-weight: 700; text-decoration: none; border-bottom: 2px dashed rgba(59, 130, 246, 0.5);">Speak
                        with an academic advisor</a>
                </p>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}
